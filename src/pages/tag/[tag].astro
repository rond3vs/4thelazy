---
// src/pages/tag/[tag].astro
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import MainLayout from '../../layouts/MainLayout.astro';
import BlogResources from '../../components/BlogResources.astro';

export async function getStaticPaths() {
  const allPosts = await getCollection('blog');
  
  // Get all unique tags
  const uniqueTags = [...new Set(allPosts.map((post: CollectionEntry<'blog'>) => post.data.tags).flat())] as string[];
  
  // Create a path for each tag
  return uniqueTags.map((tag: string) => ({
    params: { tag: tag.toLowerCase() },
    props: { tag },
  }));
}

// Define props interface
interface Props {
  tag: string;
}

const { tag } = Astro.props as Props;
---

<MainLayout>
  <div class="tag-header">
    <div class="container">
      <h1>Resources tagged with: {tag}</h1>
      <a href="/" class="back-link">‚Üê Back to all resources</a>
    </div>
  </div>
  
  <BlogResources tag={tag} />
</MainLayout>

<style>
  .tag-header {
    padding: var(--spacing-xl) 0 var(--spacing-md);
    text-align: center;
  }
  
  .back-link {
    display: inline-block;
    margin-top: var(--spacing-sm);
    color: var(--color-text-light);
    text-decoration: none;
  }
  
  .back-link:hover {
    color: var(--color-primary);
  }
</style>